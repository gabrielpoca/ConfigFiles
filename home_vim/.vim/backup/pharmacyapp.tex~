\chapter{Pharmacy App}
Na componente web do projecto a aplicação é orientada à consulta e dispensa de receitas.  Esta aplicação está construída sobre a framework CakePHP e como tal implica algum conhecimento adicional. 

\section{CakePHP}

\begin{wrapfigure}{l}{0.1\textwidth}
\vspace{-15pt}
\includegraphics[width=0.1\textwidth]{images/cake-logo.png}
\vspace{-30pt}
\end{wrapfigure}

CakePHP é uma framework desenvolvida, tal como o nome indica, em PHP implementando conceitos como \textit{Template}, \textit{Scaffold} e \textit{MVC}. A ideia é facilitar o trabalho do programador, como tal adopta a filosofia "convenção em vez de configuração", o que significa que o programador vê o seu trabalho simplificado seguindo as convenções establecidas, evitando deste modo a configurações excessivas. Como tal de modo a facilitar o trabalho algumas convencções no que refere à base de dados foram adoptadas, tal ficará explicito na secção correspondente à base de dados.

\section{Consulta}
Das principais funcionalidades da componente web é a consulta de informação. Cada tipo de informação (Médicos, Utentes, Receitas, Embalagens, etc) é listado em tabelas e pormenorizadamente, e a informação é ainda relacionada com a restante sendo sempre possivel navegar entre as relações.

\subsection{Estatisticas}

\begin{wrapfigure}{l}{0.1\textwidth}
\vspace{-10pt}
\includegraphics[width=0.1\textwidth]{images/pchart.png}
\vspace{-30pt}
\end{wrapfigure}

Por informação entenda-se informação sobre diferentes formas, como tal a componente web contém estatísticas sobre a informação em base de dados, como por exemplo o numero de embalagens prescritas por local. Tal é apresentado sobre a forma de um gráfico, gerado no momento, através da aplicação. A imagem na Figura~\ref{fig:graficolocais} apresenta um exemplo de tal informação.

\begin{figure}[here]
\centering{\includegraphics[width=0.6\textwidth]{images/graficolocais.png}}
\caption{Prototipo de imagem}
\label{fig:graficolocais}
\end{figure}

De forma a facilitar o acesso a esta informação existem views. A código para a view que permite retirar a informação no gráfico acima está apresentado no Listing~\ref{view}.

\lstset{caption={Sql da view para estatisticas do numero de medicamentos dispensados por farmácia.}, label=view}
\begin{lstlisting}
CREATE VIEW farmaciamedicamentos AS 
	SELECT farmacias.nome as nome, count(*) as count 
	FROM receitaembalagens, farmacias 
	WHERE farmacias.id = receitaembalagens.farmacia_id 
		GROUP BY farmacias.nome;
\end{lstlisting}

\section{Dispensa de Receitas}
Sendo que as aplicações devem implementar as funcionalidades de prescrição e dispensa exclusivamete optou-se por implementar a funcionalidade de dispensa na componente web, uma vez que parece enquadrar mais uma aplicação web como aplicação de "farmácia" e uma aplicação de desktop como de "médico". 

\begin{wrapfigure}{l}{0.4\textwidth}
\includegraphics[width=0.4\textwidth]{images/pharmacyprint.png}
\vspace{-25pt}
\caption{Print de uma página.}
\end{wrapfigure}

Cada farmácia possuiu um \textit{nome} e \textit{password}, como se pode ver no Listing~\ref{farmacias}, que serve o propósito de autênticação na página, após o qual é possivel navegar a informação e dispensar receitas. O processo é simples: listar receitas, selecionar receitas, selecionar \textit{Dispensa} no medicamento em causa.

De notar que a dispensa é realizada medicamento a medicamento uma vez que se pretende a possibilidade de dispensar medicamentos da mesma receita em diferentes farmácias.

\lstset{caption={Sql da tabla \textit{Farmacias}}, label=farmacias}
\begin{lstlisting}
CREATE TABLE Farmacias (
		id       number(10) NOT NULL, 
		nome     varchar2(50) NOT NULL, 
		password varchar2(250) NOT NULL, 
		PRIMARY KEY (id));
\end{lstlisting}


\section{Login}
O login é um requisito obrigatório à navegação, sendo que o mesmo é apenas permitido às farmácias. O sistema é implementado sobre o componente \textit{Auth} do CakePHP que facilita o mesmo. As passwords em base de dados devem estar encriptadas em md5 de modo a permitir autênticação.
