#!/usr/bin/ruby

require 'open-uri'

posts_folder = '_posts'
images_folder = 'images'

Dir.foreach(posts_folder) do |item|
	next if item == '.' or item == '..'
	data = File.read(posts_folder+'/'+item)
	data.scan(/"([^"]+\/([^"]+(jpg|png)))"/i) {
		puts $2
		open(images_folder+'/'+$2, 'wb') do |file|
			file << open($1).read
		end
		replace = data.gsub($1, '/'+images_folder+'/'+$2)
		File.open(posts_folder+'/'+item, "w") { |file| file.puts replace }
	}
end
