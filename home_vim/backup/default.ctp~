<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head><?=$this->Html->charset(); ?>
	  <title>
		 <?=$title_for_layout; ?>
	  </title>

	  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript"></script>

	  <?php
		 echo $this->Html->css('main');
		 echo $this->Html->css('gallery');
		 echo $this->Html->script('main');
		 echo $scripts_for_layout;
	  ?>

	  <script type="text/javascript">
		 // parse fbid and submit to /photos/add
		 function submitPhoto() {
			   var fbid = getUrlVars($("#photo-submit-input").val())['fbid'];
			   $('#content').load('<?=$this->Html->url(array('controller'=>'photos', 'action' => 'add'));?>'+'/'+fbid);
			   alert("Submited!");
		 }

		 // show submit div
		 function showSubmit() {
			   $('#submit').show();
		 }

		 // hide submit div
		 function hideSubmit() {
			   $('#submit').hide();
		 }

		 // submit user like to photo id
		 function submitLike(id) {
			   $.ajax({
					 type: "GET",
					 url: "<?=$this->Html->url(array('controller' => 'likes', 'action' => 'add'));?>"+"/"+id
			   });

		 }

		 // document ready setup
		 $(document).ready(function() {
			   $('#li-main').click(function() {
					 $('#content').load('<?=$this->Html->url(array('controller' => 'main', 'action' => 'index'));?>');
			   });
			   $('#li-profile').click(function() {
					 $('#content').load('<?=$this->Html->url(array('controller' => 'fbusers', 'action' => 'view', $user));?>');
			   });

		 });
	  </script>
   </head>
   <body>
	  <!-- HEADER DIV -->
	  <div id="header-out">
		 <div id="header">
			<div id="header-title">
			   <b><?=$this->Html->link('HotSpot', array('controller' => 'main', 'action' => 'index'));?></b>
			</div>
			<!-- HEADER: USER PIC -->
			<?php if($user): ?>
			<div id="header-username">
			   <?=$user_name?>
			</div>
			<div id="header-pic">
			   <?php echo "<img src='$user_photo' />"; ?>
			</div>			
			<div id="header-log">
			   <?php
				  if($user) {
					 echo $this->Html->link('Logout', array('controller'=>'fbusers', 'action' => 'logout'));
				  }
				  else {
					 echo $this->Html->link('Login', array('controller'=>'fbusers', 'action' => 'login'));
				  }
			   ?>
			</div>
			<?php endif; ?>
			<!-- HEADER: LOGIN AND LOGOUT -->	
			<div id="header-submit">
			   <a href="#" onClick="showSubmit();">Submit Photo</a>
			</div>
			<div class="clear"></div>
		 </div>
	  </div>
	  <div id="container">
		 <!-- SIDEBAR DIV -->
		 <div id="sidebar">
			<h3>Sidebar</h3>
			<ul>
			   <li id="li-main"><a href="#">Home</a></li>
			   <li id="li-profile"><a href="#">Profile</a></li>
			</ul>
		 </div>	
		 <div id="right-container">
			<!-- SUBMIT FORM -->
			<div id="submit">
			   <h3>Submit a Photo <span class="small"><a href="#" onClick="hideSubmit();">hide</a></span></h3>
			   <form action="<?=$this->Html->url(array('controller'=>'photos', 'action'=>'add'));?>" method="GET">
				  <input id="photo-submit-input" type="url" name="photo_url" />
				  <button id="photo-submit-button" onClick="submitPhoto();" type="button">Submit!</button>
			   </form>
			</div>
			<!-- CONTENT DIV -->
			<div id="content">
			   <br />
			   <?php echo $this->Session->flash(); ?>

			   <?php echo $content_for_layout; ?>
			</div>
		 </div>
		 <div class="clear"></div>
		 <!-- FOOTER DIV -->
		 <div id="footer">
			by Gabriel Po√ßa
		 </div>
	  </div>
	  <div style="clear:both;width:100%;">
		 <?php echo $this->element('sql_dump'); ?>
	  </div>
   </body>
</html>
